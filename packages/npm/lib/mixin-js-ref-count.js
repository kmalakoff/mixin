/*
  mixin-js-ref-count.js 0.1.5
  (c) 2011, 2012 Kevin Malakoff - http://kmalakoff.github.com/mixin/
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Dependencies: Mixin.Core
*/
(function() {
  return (function(factory) {
    // AMD
    if (typeof define === 'function' && define.amd) {
      return define('mixin-js-ref-count', ['mixin-js'], factory);
    }
    // CommonJS/NodeJS or No Loader
    else {
      return factory.call(this);
    }
  })(function() {// Generated by CoffeeScript 1.3.3
var Mixin, _;

Mixin = !window.Mixin && (typeof require !== 'undefined') ? require('mixin-js') : window.Mixin;

_ = Mixin._;

/*
  mixin-js-ref-count.js 0.1.5
  (c) 2011, 2012 Kevin Malakoff - http://kmalakoff.github.com/mixin/
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Dependencies: Mixin.Core
*/


Mixin.RefCount || (Mixin.RefCount = {});

Mixin.RefCount._mixin_info = {
  mixin_name: 'RefCount',
  initialize: function(release_callback) {
    return Mixin.instanceData(this, 'RefCount', {
      ref_count: 1,
      release_callback: release_callback
    });
  },
  mixin_object: {
    retain: function() {
      var instance_data;
      instance_data = Mixin.instanceData(this, 'RefCount');
      if (instance_data.ref_count <= 0) {
        throw new Error("Mixin.RefCount: ref_count is corrupt: " + instance_data.ref_count);
      }
      instance_data.ref_count++;
      return this;
    },
    release: function() {
      var instance_data;
      instance_data = Mixin.instanceData(this, 'RefCount');
      if (instance_data.ref_count <= 0) {
        throw new Error("Mixin.RefCount: ref_count is corrupt: " + instance_data.ref_count);
      }
      instance_data.ref_count--;
      if ((instance_data.ref_count === 0) && instance_data.release_callback) {
        instance_data.release_callback(this);
      }
      return this;
    },
    refCount: function() {
      return Mixin.instanceData(this, 'RefCount').ref_count;
    }
  }
};

Mixin.registerMixin(Mixin.RefCount._mixin_info);
; return Mixin;});
}).call(this);